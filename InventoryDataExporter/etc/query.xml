<?xml version="1.0"?>
<!--
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */
-->
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_QueryXml:etc/query.xsd">
    <query name="stockStatus">
        <source name="inventory_source_item">
            <attribute name="source_item_id" alias="id"/>
            <attribute name="source_code" alias="sourceCode"/>
            <attribute name="sku" alias="sku"/>
            <attribute name="status" alias="isSalable"/>
            <filter glue="and">
                <condition attribute="source_item_id" operator="in" type="placeholder">sourceItemIds</condition>
            </filter>
            <link-source name="inventory_source_stock_link" link-type="inner">
                <attribute name="stock_id" alias="stockId"/>
                <using glue="and">
                    <condition attribute="source_code" operator="eq" type="identifier">source_code</condition>
                </using>
            </link-source>
            <link-source name="inventory_low_stock_notification_configuration" link-type="inner">
                <attribute name="notify_stock_qty" alias="notifyStockQty"/>
                <using glue="and">
                    <condition attribute="source_code" operator="eq" type="identifier">source_code</condition>
                </using>
                <using glue="and">
                    <condition attribute="sku" operator="eq" type="identifier">sku</condition>
                </using>
            </link-source>
            <link-source name="catalog_product_entity" link-type="inner">
                <attribute name="entity_id" alias="productId"/>
                <using glue="and">
                    <condition attribute="sku" operator="eq" type="identifier">sku</condition>
                </using>
            </link-source>
            <link-source name="cataloginventory_stock_item" link-type="inner">
                <attribute name="min_sale_qty" alias="minSaleQty"/>
                <using glue="and">
                    <condition attribute="product_id" operator="eq" type="identifier">catalog_product_entity.entity_id</condition>
                </using>
            </link-source>
            <link-source name="inventory_reservation" link-type="left">
                <attribute name="quantity" alias="reservedQty"/>
                <using glue="and">
                    <condition attribute="sku" operator="eq" type="identifier">sku</condition>
                </using>
                <using glue="and">
                    <condition attribute="stock_id" operator="eq" type="identifier">inventory_source_stock_link.stock_id</condition>
                </using>
            </link-source>
        </source>
    </query>
</config>